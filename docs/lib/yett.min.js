!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.yett={})}(this,function(t){"use strict";var e=window.TYPE_SANDBOX,r={blacklist:null,whitelist:null},i={blacklist:window.YETT_BLACKLIST,whitelist:window.YETT_WHITELIST};!(i.blacklist instanceof Array)&&i.blacklist instanceof Object&&(r.blacklist=i.blacklist,i.blacklist=Object.keys(r.blacklist)),!(i.whitelist instanceof Array)&&i.whitelist instanceof Object&&(r.whitelist=i.whitelist,i.whitelist=Object.keys(r.whitelist));var n={blacklisted:[]},c={blacklisted:[]},l=function(t,e){return t&&(!e||"javascript/blocked"!==e)&&(!i.blacklist||i.blacklist.some(function(e){return e.test(t)}))&&(!i.whitelist||i.whitelist.every(function(e){return!e.test(t)}))},s=function(t){var e=t.getAttribute("src");return i.blacklist&&i.blacklist.every(function(t){return!t.test(e)})||i.whitelist&&i.whitelist.some(function(t){return t.test(e)})},o=new MutationObserver(function(t){t.forEach(function(t){for(var r=t.addedNodes,i=function(t){var i=r[t];if(1===i.nodeType&&"SCRIPT"===i.tagName){var s=i.src,o=i.type;if(l(s,o)){n.blacklisted.push(i.cloneNode()),i.type="javascript/blocked";i.addEventListener("beforescriptexecute",function t(e){"javascript/blocked"===i.getAttribute("type")&&e.preventDefault(),i.removeEventListener("beforescriptexecute",t)}),i.parentElement.removeChild(i)}}if(1===i.nodeType&&"IFRAME"===i.tagName&&!1!==e){var a=i.src;l(a)&&(c.blacklisted.push(i.cloneNode()),"remove"===e?i.src="":i.sandbox=e)}},s=0;s<r.length;s++)i(s)})});o.observe(document.documentElement,{childList:!0,subtree:!0});var a={src:Object.getOwnPropertyDescriptor(HTMLScriptElement.prototype,"src"),type:Object.getOwnPropertyDescriptor(HTMLScriptElement.prototype,"type")},u=document.createElement;document.createElement=function(){for(var t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];if("iframe"===r[0].toLowerCase()&&!1!==e){if("remove"===e)return null;var n=u.bind(document).apply(void 0,r);return Object.defineProperties(n,{src:{get:function(){return a.src.get.call(this)},set:function(t){return l(t,n.type)&&(n.sandbox=e),a.src.set.call(this,t)}},sandbox:{set:function(t){return a.type.set.call(this,l(n.src)?e:t)}}}),n.setAttribute=function(t,e){"sandbox"===t||"src"===t?n[t]=e:HTMLScriptElement.prototype.setAttribute.call(n,t,e)},n}if("script"!==r[0].toLowerCase())return u.bind(document).apply(void 0,r);var c=u.bind(document).apply(void 0,r);return Object.defineProperties(c,{src:{get:function(){return a.src.get.call(this)},set:function(t){return l(t,c.type)&&(c.type="javascript/blocked"),a.src.set.call(this,t)}},type:{set:function(t){return a.type.set.call(this,l(c.src,c.type)?"javascript/blocked":t)}}}),c.setAttribute=function(t,e){"type"===t||"src"===t?c[t]=e:HTMLScriptElement.prototype.setAttribute.call(c,t,e)},c};var p=function(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)},f=new RegExp("[|\\{}()[\\]^$+*?.]","g"),b=function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];e.length<1?(i.blacklist=[],i.whitelist=[]):(i.blacklist instanceof Array&&(i.blacklist=i.blacklist.filter(function(t){return e.every(function(e){return!t.test(e)})})),i.whitelist instanceof Array&&(i.whitelist=[].concat(p(i.whitelist),p(e.map(function(t){var e=".*"+t.replace(f,"\\$&")+".*";return i.whitelist.find(function(t){return t.toString()===e.toString()})?null:new RegExp(e)}).filter(Boolean)))));for(var c=document.querySelectorAll('script[type="javascript/blocked"]'),l=0;l<c.length;l++){var a=c[l];s(a)&&(a.type="application/javascript",n.blacklisted.push(a),a.parentElement.removeChild(a))}var u=0;[].concat(p(n.blacklisted)).forEach(function(t,e){if(s(t)){var r=document.createElement("script");r.setAttribute("src",t.src),r.setAttribute("type","application/javascript"),document.head.appendChild(r),n.blacklisted.splice(e-u,1),u++}}),i.blacklist&&i.blacklist.length<1&&o.disconnect()};t.unblock=b,t.unblockId=function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];e.forEach(function(t){if(r.blacklist instanceof Object)try{b(r.blacklist[t])}catch(t){}if(r.whitelist instanceof Object)try{b(r.whitelist[t])}catch(t){}})},Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=yett.min.js.map
